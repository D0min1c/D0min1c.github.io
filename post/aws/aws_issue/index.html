<!doctype html><html class=no-js lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#1b1b1b"><title>아니 글쎄 갑자기 VM이 죽었다니까요? - AWS | 255.255.248.0</title><script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script><meta name=description content><meta property="og:title" content="아니 글쎄 갑자기 VM이 죽었다니까요? - AWS"><meta property="og:description" content="AWS/GCP에서 일어나는 VM이 갑자기 뻗거나 리부팅되는 이유에 대해&mldr;"><meta property="og:type" content="article"><meta property="og:url" content="https://21sub.net/post/aws/aws_issue/"><meta itemprop=name content="아니 글쎄 갑자기 VM이 죽었다니까요? - AWS"><meta itemprop=description content="AWS/GCP에서 일어나는 VM이 갑자기 뻗거나 리부팅되는 이유에 대해&mldr;"><meta itemprop=wordCount content="335"><meta itemprop=keywords content="aws,public cloud,"><meta name=twitter:card content="summary"><meta name=twitter:title content="아니 글쎄 갑자기 VM이 죽었다니까요? - AWS"><meta name=twitter:description content="AWS/GCP에서 일어나는 VM이 갑자기 뻗거나 리부팅되는 이유에 대해&mldr;"><link rel=stylesheet href=/css/bundle.css><link rel=stylesheet href=/css/custom.css><link rel=icon href=/icons/16.png sizes=16x16 type=image/png><link rel=icon href=/icons/32.png sizes=32x32 type=image/png><link rel=manifest href=/manifest.json><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-199142344-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="body kind-page"><header class=header><a class=logo href=/>255.255.248.0</a><nav class="main-nav main-nav--right" role=navigation><button id=toggle class=main-nav__btn aria-label="Menu toggle" aria-expanded=false tabindex=0><div class=main-nav__btn-box tabindex=-1><svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18"><path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/><path class="icon-menu__x" d="M11.55 9 18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55.0 9 6.45 15.45.0 18 2.55 11.55 9z"/></svg></div></button><ul id=menu class=main-nav__list><li class=main-nav__item><a class=main-nav__link href=/%EA%B0%9C%EC%9D%B8/><span class=main-nav__text>About Dominic</span></a></li></ul></nav></header><div class=primary><main class=main><nav class="breadcrumb block" aria-label=breadcrumb><ol class=breadcrumb__list><li class=breadcrumb__item><a class=breadcrumbs__link href=/>21sub.net</a></li><li class=breadcrumb__item><a class=breadcrumbs__link href=/post/>Posts</a></li><li class="breadcrumbs__item breadcrumb__item--active" aria-current=page>아니 글쎄 갑자기 VM이 죽었다니까요? - AWS</li></ol></nav><div class="single block"><article class=entry><div class="entry__meta meta mb"><span class="entry__meta-categories meta-categories"><span class=meta-categories__list>Categories:
<a class=meta-categories__link href=/categories/cloud/ rel=category>cloud</a></span></span></div><h1 class=entry__title>아니 글쎄 갑자기 VM이 죽었다니까요? - AWS</h1><div class=entry__content><p>AWS/GCP에서 일어나는 VM이 갑자기 뻗거나 리부팅되는 이유에 대해&mldr;</p><h2 id=배경>배경</h2><p>GCP 혹은 AWS를 사용하면서 종종 Host Error! 혹은 Instance check Failed를 경험한 적이 있으시죠?
우선 AWS를 기준으로 이슈에 대해 정리해보았습니다.</p><h3 id=aws-system-check-failed>AWS System Check failed</h3><p>다들 아시다시피 ec2 인스턴스는 <strong>AWS에서 Iaas 방식으로 제공하는 서비스</strong>이기에 사용자가 해당 ec2 인스턴스를 프로비저닝하게 될 경우 선택한 리전과 가용영역의 데이터 센터 내 host computer에서 hypervisor 위에 고객의 요청에 의해 insatnce를 생성하여 제공하는 방식입니다.</p><p>여기서 만약 hypervisor와 instance간의 Network이 끊긴다면..? 아니면 Host 장비에 불이 난다면&mldr;?</p><p><strong>와장창-!</strong> 말 그대로 인스턴스가 와장창 납니다.</p><p>이러한 갑작스러운 이슈로 인해 발생하는 AWS 하드웨어의 Maintenance Event 혹은 System checkfailed 이슈로 인해 발생하는 예기치않은 이슈에 대해 정리하고 사례에 맞춰 사용자들은 어떻게 대처해야하는지에 경험을 공유하고자 합니다.</p><h2 id=종류>종류</h2><p>우선 AWS에서의 EC2 Event 종류와 Cloudwatch에서 확인할 수 있는 Status Check failed 지표는 아래와 같은 내용을 포함합니다.</p><ul><li><p>AWS Event</p><ul><li>Instance stop : 예약된 시간에 인스턴스가 중지됩니다. 인스턴스를 다시 시작하면 <strong>새 호스트로 마이그레이션됩니다.</strong></li></ul><p>이러한 유형은 Amazon EBS가 지원하는 인스턴스에만 적용됩니다.</p><ul><li>Instance retirement</li><li>Instance reboot</li><li>System reboot</li><li>System maintenance</li></ul></li></ul><h3 id=instance-stop>Instance stop</h3><p>: 예약된 시간에 인스턴스가 중지됩니다. 인스턴스를 다시 시작하면 <strong>새 호스트로 마이그레이션됩니다.</strong></p><p>Instance stop이 일어나는 경우는 대게 Host hardware의 폐기 날이 결정된 것입니다.</p><p>이 경우, Maintenance 일정 이전에 스스로 stop/start를 진행하여 해소 할 수 있습니다.</p><p>두 눈을 크게 뜨고 정확히 봐야합니다. Instance reboot이 아닌, Stop인 것을요.</p><p>Stop되어있는 인스턴스는 어떤 트리거가 발생하기 전까지는 결코 혼자서 벌떡 일어나진 않습니다.</p><pre><code>이러한 유형은 Amazon EBS가 지원하는 인스턴스에만 적용됩니다.
</code></pre><h3 id=instance-retirement>Instance retirement</h3><p>: 예약된 시간에 인스턴스가 Amazon EBS에서 지원되는 경우 중지되거나 인스턴스 스토어에서 지원되는 경우 종료됩니다.</p><p>말 그대로 EBS 지원 인스턴스는 stop, 인스턴스스토어 지원 인스턴스는 terminate되는 이벤트입니다.</p><p>아직 발생해본적이 없어서 패스하겠습니다. (뭐..다를거 있겠냐만..)</p><h3 id=system-maintenance>System maintenance</h3><p>: 예약된 시간에 네트워크 또는 전력 유지 관리로 인스턴스가 일시적인 영향을 받을 수 있습니다</p><p>네트워크 유지 관리 시에는 예약된 인스턴스의 네트워크 연결이 잠시 동안 끊어집니다. 유지 관리가 완료되면 인스턴스의 네트워크 연결이 평소처럼 복구됩니다.</p><p>전력 유지 관리 시에는 예약된 인스턴스가 잠시 동안 오프라인 상태로 전환되었다가 재부팅됩니다. 재부팅 이후에도 인스턴스의 모든 구성 설정은 그대로 유지됩니다.</p><h3 id=instance-reboot>Instance reboot</h3><p>: 예약된 시간에 인스턴스가 재부팅됩니다.</p><p>하이라이트 입니다. 과연 인스턴스 리붓과 시스템 리붓의 차이는</p><h3 id=system-reboot>System reboot</h3><p>: 예약된 시간에 인스턴스의 호스트가 재부팅됩니다.</p><p>.</p></div><footer class=entry__footer><div class=entry__tags><a class="entry__tag btn" href=/tags/aws/>aws</a>
<a class="entry__tag btn" href=/tags/public-cloud/>public cloud</a></div></footer></article></div></main><div class="authorbox block"><div class=author><figure class=author__avatar><img class=author__img alt="Dominic avatar" src=/img/avatar.png height=90 width=90></figure><div class=author__body><div class=author__name>Dominic</div><div class=author__bio>Dominic's true identity is unknown. Maybe he is a cute fairy or slave :D</div></div></div></div><div class="related block"><h3 class=related__title>Related</h3><ul class=related__list><li class=related__item><a class=related__link href=/post/gcp/gcp_clb_1/>GCP-Cloud Load Balancer(1) 내용정리</a></li><li class=related__item><a class=related__link href=/post/gcp/gcp_clb_2/>GCP-Cloud Load Balancer(2) 테스트</a></li></ul></div><section class="comments block"><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"dominic"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><footer class=footer><div class="footer__social social"><a class=social__link target=_blank rel="noopener noreferrer" href=https://www.instagram.com/seob.199b><svg class="social__icon" aria-label="Instagram" role="img" width="32" height="32" viewBox="0 0 512 512"><g fill="none" stroke-width="29"><rect height="296" rx="78" width="296" x="108" y="108"/><circle cx="256" cy="256" r="69"/></g><circle cx="343" cy="169" r="19"/></svg></a><a class=social__link target=_blank rel="noopener noreferrer" href=https://linkedin.com/in/hanseob-lee-9655781aa><svg class="social__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg></a><a class=social__link target=_blank rel="noopener noreferrer" href=https://github.com/D0min1c><svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg></a></div><div class=footer__copyright>© 2021 Binario. <span class=footer__copyright-credits>Powered by <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/vimux/binario rel="nofollow noopener" target=_blank>Binario</a> theme.</span></div></footer><script src=/js/menu.js></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script><script src=/js/custom.js></script></body></html>