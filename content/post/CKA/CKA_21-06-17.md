---
title: CKA 정리 (21-06-17 Pods, Template)
categories:
  - "CKA"
tags:
  - "k8s"
  - "CKA"
  - "Kubernetes"
---
2021-06-15부터 CKA 취득을 위해 이론적으로 공부한 내용들을 데일리로 기록하였습니다.
<!--more-->

## 배경
CKA라는 핑계를 통해, 쿠버네티스에 입문해보자

## 2021-06-17 공부한 내용
#### Pods
  - pods는 일회용이다.
    - 애초에 일회용 엔티티로 설계되었다.
    - 워크로드 리소스를 사용하여 여러 파드를 만들고 관리할 수 있다. 리소스에 대한 컨트롤러는 파드 장애 시 복제 및 롤아웃과 자동 복구를 처리한다. 예를 들어, 노드가 실패하면, 컨트롤러는 해당 노드의 파드가 작동을 중지했음을 인식하고 대체 파드를 생성한다. 스케줄러는 대체 파드를 정상 노드에 배치한다.
  - Pods Template 작성 간 Kind를 어떤걸로 선택하느냐에 따라 동작이 다르다. 
    - Deployment
      - pods와 replicaset에 대한 정의 (파드를 몇 개 생성할지..그에 대한 가용성을 몇개까지 유지할지 (항상 x대 이상의 파드는 실행되어야함))
      - Deployment controller에서 deployment를 정의하고 제거하고 적용한다. (deployment 롤백도 가능)
      - replicaset은 label값을 참고하여 pods의 소속을 확인한다. 그렇기에 relicaset에 속해져있는 Pods는 지워도 replicaset에 의해 부활한다. (pods에 label을 따로 부여하여 파드를 ~~광복x~~ 독립시키면 됨..!)
      - replcatset을 지우면 pods와 함께 삭제되는데 --cascade=false 옵션으로 파드는 남겨둘 수 있다.
      - kubectl scale replcaset ~ ~ 명령어를 통해 실시간으로 스케일링 가능


    - Statefulset
      - 말그대로 상태를 유지하는 파드를 생성하고 관리.
      - 상태를 어떻게 유지할까 -> statefilset controller에서 각 파드별로 넘버링을 한다 
      - 스케일링은 동일하게 relicaset으로 진행 
      - 그럼 deployment랑 뭐가 다르냐! 위에서 말한 파드의 독자성을 유지함에 차이가 있다. (파드들이 동일한 스펙으로 생성되어도 독자성을 가지고 있기에 서로 대체할 수 없다.
      - deployment는 파드를 삭제하면 연관된 볼륨이 같이 삭제되는데, 얘는 파드를 삭제해도 볼륨은 남겨놓는다. 데이터의 안전을 보장한다.
    
    - demonset
      - 특정 노드 또는 모든 노드에 **항상** 실행되어 있어야 하는 특정 파드들을 관리한다. 가령 로그수집용도의 파드들..!

    - Jobs
      - 1개 이상의 파드를 생성하고 지정된 수의 파드가 성공적으로 종료될 때까지 계속 파드의 실행을 요청한다. ~~(오,,,익숙한데)~~
      - 가령 노드 재부팅으로 파드가 실패하거나 삭제된 경우 job이 파드가 정상적으로 종료되지 않았다고 판단하여 다시 파드를 생성한다.
      - 잡이 완료되면 파드는 더 이상 생성되지 않지만, 잡이 사라지진 않는다. 내비두면 API서버에 부담을 주기에 생성부터 "activeDeadlineSeconds" 옵션으로 적당히 종료시키거나 Crontab을 통해 정리하는 방법이 좋다.
      - 1.21 이상 버전부턴 일시중지를 지원한다 !!_!_!__!_!_!_



