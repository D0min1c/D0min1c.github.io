<!doctype html><html><head><title>k8s(GKE-Pod)</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/site/favicon_hu1d79931af21da1953430965fd067c561_13812_42x0_resize_q75_box.JPG><meta property="og:title" content="k8s(GKE-Pod)"><meta property="og:description" content="Sample post with multiple images, embedded video ect."><meta property="og:type" content="article"><meta property="og:url" content="https://hugo-toha.github.io/posts/cloud/gcp/k8sgke-pod/"><meta property="article:published_time" content="2021-06-26T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-26T00:00:00+00:00"><meta name=description content="Sample post with multiple images, embedded video ect."><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-199142344-2','auto');ga('send','pageview');}</script></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu1d79931af21da1953430965fd067c561_13812_42x0_resize_q75_box.JPG alt=Logo>
255.255.248.0</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/site/main-logo_hu1d79931af21da1953430965fd067c561_13812_42x0_resize_q75_box.JPG class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hu1d79931af21da1953430965fd067c561_13812_42x0_resize_q75_box.JPG class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/about_dominic/ title=ğŸ˜About_dominicğŸ˜>ğŸ˜About_dominicğŸ˜</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cloud/>Cloud</a><ul class=active><li><i class="fas fa-plus-circle"></i><a href=/posts/cloud/aws/>AWS</a><ul><li><a href=/posts/cloud/aws/awshost_issue/ title="AWSì´ìŠˆ (Host error)">AWSì´ìŠˆ (Host error)</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/cloud/gcp/>GCP</a><ul class=active><li><a href=/posts/cloud/gcp/gcpissue-1/ title="GCP ì´ìŠˆ (ê°‘.ì„œ.ë°•)">GCP ì´ìŠˆ (ê°‘.ì„œ.ë°•)</a></li><li><a href=/posts/cloud/gcp/gcpnetwork-1/ title="GCP-VPC ê¸°ì´ˆ 1í¸">GCP-VPC ê¸°ì´ˆ 1í¸</a></li><li><a href=/posts/cloud/gcp/gcpnetwork-2/ title="GCP-VPC ê¸°ì´ˆ 2í¸">GCP-VPC ê¸°ì´ˆ 2í¸</a></li><li><a class=active href=/posts/cloud/gcp/k8sgke-pod/ title=k8s(GKE-Pod)>k8s(GKE-Pod)</a></li><li><a href=/posts/cloud/gcp/k8sgke-service/ title=k8s(GKE-Service)>k8s(GKE-Service)</a></li><li><a href=/posts/cloud/gcp/k8sgke-volume/ title=k8s(GKE-volume)>k8s(GKE-volume)</a></li></ul></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/kubernetes/>Kubernetes</a><ul><li><a href=/posts/kubernetes/k8snetworking/ title=k8s(Networking)>k8s(Networking)</a></li><li><a href=/posts/kubernetes/k8scomponent/ title=k8s(component)>k8s(component)</a></li><li><a href=/posts/kubernetes/k8singress/ title=k8s(Ingress)>k8s(Ingress)</a></li><li><a href=/posts/kubernetes/k8svolume/ title=k8s(Volume)>k8s(Volume)</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/certification/>Certification</a><ul><li><a href=/posts/certification/cka/ title=CKA>CKA</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://hugo-toha.github.io/posts/cloud/gcp/k8sgke-pod/images/CKA_thumnail.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/dominic_hue8656283646074d0d4d459b13fee860e_56605_120x120_fit_box_2.png alt="Author Image"><h5 class=author-name>dominic</h5><p>June 26, 2021</p></div><div class=title><h1>k8s(GKE-Pod)</h1></div><div class=post-content id=post-content><p>GKEë¥¼ ìƒì„±í•´ì„œ kubectlì— ìµìˆ™í•´ì ¸ë³´ì.</p><h3 id=gkegoogle-kubernetes-engine>GKE(google Kubernetes Engine)</h3><p>ê¸°ì¡´ ì¿ ë²„ë„¤í‹°ìŠ¤ì™€ ë™ì¼í•˜ê²Œ Master(Control Plane)ê³¼ Worker Nodeë¡œ êµ¬ì„±ë˜ì–´ìˆìœ¼ë©°, GCP ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ì´ê¸°ì— ë…¸ë“œ í™•ì¥ ë“±ì˜ í¸ë¦¬í•¨ì´ ìˆë‹¤. (arg. AWS EKS&mldr;)
ê·¸ì €, ìœ„ì¹˜ì™€ k8s ë²„ì „, Network (VPC) í™˜ê²½ê³¼ IP ëŒ€ì—­ë§Œ ì„¤ì •í•˜ë©´ ë‚´ë¶€ì— ì•Œì•„ì„œ k8s clusterë¥¼ ìƒì„±í•´ì¤€ë‹¤.</p><h4 id=node-pool>node pool</h4><p>nodeì— ëŒ€í•œ ìœ„ì¹˜, ìˆ˜ëŸ‰, ìŠ¤í™, ìš´ì˜ì²´ì œ, ì…€í”„íë§, ë…¸ë“œ ì—…ê·¸ë ˆì´ë“œ ì •ì±…, ìµœëŒ€ Pod/node ê°¯ìˆ˜ë¥¼ ì„ íƒí•œë‹¤.</p><h3 id=gke-í´ëŸ¬ìŠ¤í„°-ìƒì„±>GKE í´ëŸ¬ìŠ¤í„° ìƒì„±</h3><p>ì„¸ìƒì´ ì´ë ‡ê²Œ ì¢‹ì•„ì¡Œë‹¤. ì§§ì€ CLI í•œì¤„ë¡œ GKE í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p><pre><code>gcloud container clusters create dominic-gke-1

&lt;---ê²°ê³¼ê°’---&gt;
kubeconfig entry generated for dominic-gke-1.
NAME           LOCATION       MASTER_VERSION   MASTER_IP     MACHINE_TYPE  NODE_VERSION     NUM_NODES  STATUS
dominic-gke-1  us-central1-a  1.19.9-gke.1900  ë¹„-ë°€-ì„       e2-medium   1.19.9-gke.1900        3      RUNNING

</code></pre><p><img src=images/gke_1.jpg alt="This is an image"></p><p>3ëŒ€ì˜ ë…¸ë“œë¡œ ì´ë¤„ì§„ GKEê°€ ìƒì„±ë˜ì—ˆë‹¤. í´ëŸ¬ìŠ¤í„° ì‚¬ìš©ì ì¸ì¦ ì •ë³´ê°€ í•„ìš”í•˜ë‹¤.</p><h3 id=gke-í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì •ë³´-ê°±ì‹ >GKE í´ëŸ¬ìŠ¤í„° ì¸ì¦ì •ë³´ ê°±ì‹ </h3><pre><code>gcloud container clusters get-credentials dominic-gke-1
</code></pre><p>ì´ì œ GKE ì…‹íŒ…ì€ ì™„ë£Œí•˜ì˜€ìœ¼ë‹ˆ, ë­ë¼ë„ ë°°í¬í•´ë³´ì ì œì¼ ì¢‹ì•„í•˜ëŠ” Hello, worldë¥¼&mldr;kubtctl create deploymentë¥¼ í†µí•´ ìƒˆ ë°°í¬ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.</p><h3 id=gke-deplotyment>GKE deplotyment</h3><pre><code>kubectl create deployment hello-server --image=gcr.io/google-samples/hello-app:1.0
</code></pre><p>ë°°í¬ê°€ ì •ìƒì ìœ¼ë¡œ ì´ë¤„ì¡Œë‹¤ë©´ íŒŒë“œê°€ ì˜¬ë¼ì™€ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì.</p><pre><code>kubectl get pod -o wide

&lt;---ê²°ê³¼ê°’---&gt;
NAME                            READY   STATUS    RESTARTS   AGE    IP          NODE                                           NOMINATED NODE   READINESS GATES
hello-server-76d47868b4-q5mrf   1/1     Running   0          109s   10.40.0.6   gke-dominic-gke-1-default-pool-601c4b2c-tqvk   &lt;none&gt;           &lt;none&gt;
</code></pre><p>íŒŒë“œê°€ <strong>gke-dominic-gke-1-default-pool-601c4b2c-tqvk</strong>ë¼ëŠ” ë…¸ë“œì— ë°°í¬ë˜ì–´ 1ê°œì˜ ì»¨í…Œì´ë„ˆê°€ ì˜ ì‹¤í–‰ë˜ì–´ìˆë‹¤.</p><h3 id=gke-expose-serivce>GKE expose serivce</h3><p>kubectl expose ëª…ë ¹ì–´ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œí•´ì„œ ì²´í¬í•´ë³´ì</p><pre><code>kubectl expose deployment hello-server --type=LoadBalancer --port 8080

&lt;---ê²°ê³¼ê°’---&gt;
service/hello-server exposed
</code></pre><p>kubectl get serviceë¡œ í™•ì¸í•´ë³´ë©´</p><pre><code>kubectl get services

&lt;---ê²°ê³¼ê°’---&gt;
NAME           TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE
hello-server   LoadBalancer   10.43.246.172   &lt;pending&gt;     8080:32709/TCP   33s
</code></pre><p>ìƒì„±í•œ serviceì˜ IPë¥¼ ì•Œ ìˆ˜ ìˆë‹¤. <del>ì•„ì§ Pendingì´ë©´ ìš°ì„  ê¸°ë‹¤ë ¤ë³´ì.</del> ë‚´ ì„œë¹„ìŠ¤ LBì˜ IPëŠ” 34.134.44.184ë‹¤.</p><h3 id=gke-service-test>GKE service test</h3><p><img src=images/gke_2.jpg alt="This is an image"></p><p>ì´ë ‡ê²Œ ì™¸ë¶€ì—ì„œ 8080 í¬íŠ¸ë¥¼ í†µí•´ ì ‘ê·¼í–ˆì„ ë•Œ, íŒŒë“œ ë‚´ ì»¨í…Œì´ë„ˆì˜ Hello, world webì´ ì ‘ê·¼ë˜ëŠ”ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.</p><p>ê¹”ë”í•˜ë‹¤. CNIë„ ê³ ë¯¼ì—†ì´ ê·¸ëƒ¥ GKEì˜ CNIë¥¼ ì‚¬ìš©í–ˆë‹¤.</p><h3 id=gke-ê¸°ë³¸-cni-í™˜ê²½>GKE ê¸°ë³¸ CNI í™˜ê²½</h3><p><br>GKEì˜ CNIë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ê°€ìƒ ì´ë”ë„· ê¸°ê¸°(veth) ìŒì˜ í•œìª½ ëì€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ podì— ì—°ê²°ë˜ê³  ë‹¤ë¥¸ í•œìª½ ëì€ Linux ë¸Œë¦¬ì§€ ê¸°ê¸° cbr0ì— ì—°ê²°ëœë‹¤.</p><p>ì´ ê²½ìš° ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ cbr0ì— ì—°ê²°ëœ podì˜ MAC ì£¼ì†Œê°€ í‘œì‹œëœë‹¤.</p><pre><code>arp -n
</code></pre><p>ë˜í•œ ì´ì „ k8s-networkì—ì„œ í™•ì¸í–ˆë“¯ì´ brctl ëª…ë ¹ì–´ë¥¼ í†µí•´ cbr0ì— ì—°ê²°ëœ ê° veth ìŒì˜ ë£¨íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ í™•ì¸ëœë‹¤.</p><pre><code>brctl show cbr0
</code></pre><p><img src=images/gke_3.jpg alt="This is an image"></p><p>GKEë¥¼ í•œë²ˆ ì¨ë³¸ ê²ƒìœ¼ë¡œ ì¢€ ë” kube~ëª…ë ¹ì–´ì— ìµìˆ™í•´ì§„ ëŠë‚Œì´ë„ê¹Œ&mldr;ğŸ˜…ğŸ˜…</p><p><del>ê¸°ë¶„íƒ“ì¼ì§€ë„ ëª¨ë¥¸ë‹¤.</del></p></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#gkegoogle-kubernetes-engine>GKE(google Kubernetes Engine)</a><ul><li><a href=#node-pool>node pool</a></li></ul></li><li><a href=#gke-í´ëŸ¬ìŠ¤í„°-ìƒì„±>GKE í´ëŸ¬ìŠ¤í„° ìƒì„±</a></li><li><a href=#gke-í´ëŸ¬ìŠ¤í„°-ì¸ì¦ì •ë³´-ê°±ì‹ >GKE í´ëŸ¬ìŠ¤í„° ì¸ì¦ì •ë³´ ê°±ì‹ </a></li><li><a href=#gke-deplotyment>GKE deplotyment</a></li><li><a href=#gke-expose-serivce>GKE expose serivce</a></li><li><a href=#gke-service-test>GKE service test</a></li><li><a href=#gke-ê¸°ë³¸-cni-í™˜ê²½>GKE ê¸°ë³¸ CNI í™˜ê²½</a></li></ul></li></ul></nav></div></div></section></div><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>